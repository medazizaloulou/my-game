<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ø³Ø±ÙŠØ¹ - Ù†Ø³Ø®Ø© Ø£Ø¨Ø³Ø·</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: url("khalfeya.jpg") no-repeat center center fixed;
  background-size: cover;
  color: white;
  text-align: center;
  padding-top: 50px;
  margin: 0;
}
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.45);
  z-index: -1;
}

#box {
  position: absolute;
  display: none;
  cursor: pointer;
  border-radius: 10px;
}
#box:active { transform: scale(0.9); transition:0.1s; }

button {
  margin: 5px;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
}

#timeBarContainer {
  width: 80%;
  height: 20px;
  background: #ddd;
  margin: 10px auto;
  border-radius: 10px;
}
#timeBar { height:100%; width:100%; background:red; border-radius:10px; }

.high-score-box {
  position: fixed;
  top: 15px;
  right: 20px;
  font-size: 18px;
  font-weight: bold;
  background: linear-gradient(45deg, gold, orange);
  color: black;
  padding: 10px 18px;
  border-radius: 12px;
  box-shadow: 0 0 10px rgba(255,215,0,0.7);
  transition:0.3s;
}
.high-score-box.animate { transform: scale(1.2); box-shadow:0 0 25px gold; }
</style>
</head>

<body>

<p id="highScore" class="high-score-box">ğŸ† Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø·Ø©: 0</p>

<h1>ğŸ® Ø§Ù„Ø¹Ø¨ ÙÙˆØ±Ù‹Ø§</h1>
<p id="score">Ø§Ù„Ù†Ù‚Ø§Ø·: 0</p>
<p id="timer">Ø§Ù„ÙˆÙ‚Øª: 30</p>

<div>
<p>Ø§Ø®ØªØ± ÙˆØ¶Ø¹ Ø§Ù„Ù„Ø¹Ø¨Ø©:</p>
<select id="difficultySelect">
  <option value="slow">ğŸ¢ Ø¨Ø·ÙŠØ¡</option>
  <option value="normal" selected>âš¡ Ø¹Ø§Ø¯ÙŠ</option>
  <option value="hard">ğŸ”¥ ØµØ¹Ø¨</option>
  <option value="insane">ğŸ’¥ Ù…Ø¬Ù†ÙˆÙ†</option>
</select>
</div>

<div id="timeBarContainer">
  <div id="timeBar"></div>
</div>

<button id="startBtn">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
<button id="restartBtn" style="display:none;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨</button>
<button id="stopBtn">Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù„Ø¹Ø¨Ø©</button>

<div id="box"></div>

<script>
// ===== Ø§Ù„Ø£ØµÙˆØ§Øª =====
let clickSound = new Audio("click.mp3");
let startSound = new Audio("start.mp3");

// ===== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª =====
let score = 0;
let speed = 2000; // Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
let timeLeft = 30;
let totalTime = 30;
let gameRunning = false;
let timerInterval;
let boxTimeout;

let highScore = localStorage.getItem("highScore") || 0;

let box = document.getElementById("box");
let timeBar = document.getElementById("timeBar");
let highScoreElement = document.getElementById("highScore");

let difficulty = "normal";

highScoreElement.innerText = "ğŸ† Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø·Ø©: " + highScore;

document.getElementById("difficultySelect").onchange = function() {
  difficulty = this.value;
};

function startWithSound() {
  document.getElementById("startBtn").style.display="none";
  startSound.currentTime=0; startSound.play();
  setTimeout(()=>{ startGame(); },4000);
}

function startGame(){
  score=0;
  timeLeft=totalTime;
  gameRunning=true;

  document.getElementById("score").innerText="Ø§Ù„Ù†Ù‚Ø§Ø·: 0";
  document.getElementById("timer").innerText="Ø§Ù„ÙˆÙ‚Øª: "+timeLeft;
  timeBar.style.width="100%";

  document.getElementById("restartBtn").style.display="inline-block";

  // ØªØ­Ø¯ÙŠØ¯ Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ÙˆØ¶Ø¹
  switch(difficulty){
    case "slow": speed=2500; break;
    case "normal": speed=2000; break;
    case "hard": speed=1500; break;
    case "insane": speed=1000; break;
  }

  clearInterval(timerInterval);
  timerInterval=setInterval(()=>{
    if(!gameRunning) return;
    timeLeft--;
    document.getElementById("timer").innerText="Ø§Ù„ÙˆÙ‚Øª: "+timeLeft;
    timeBar.style.width=(timeLeft/totalTime*100)+"%";
    if(timeLeft<=0) endGame();
  },1000);

  showBox();
}

function getRandomColor(){
  let letters="0123456789ABCDEF", color="#";
  for(let i=0;i<6;i++) color += letters[Math.floor(Math.random()*16)];
  return color;
}

function showBox(){
  if(!gameRunning) return;

  // Ø­Ø¬Ù… Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø­Ø³Ø¨ Ø§Ù„ÙˆØ¶Ø¹
  let baseSize = (difficulty=="slow")?80:(difficulty=="normal"?60:(difficulty=="hard"?50:40));
  let size = Math.random()*20 + baseSize;
  box.style.width = size + "px";
  box.style.height = size + "px";

  let x = Math.random() * Math.max(window.innerWidth - size, 0);
  let y = Math.random() * Math.max(window.innerHeight - 200 - size, 0);

  box.style.left = x + "px";
  box.style.top = y + "px";
  box.style.background = getRandomColor();
  box.style.display = "block";

  // ØªØ³Ø§Ø±Ø¹ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ: ÙƒÙ„ 5 Ù†Ù‚Ø§Ø· ÙŠØµØ¨Ø­ Ø£Ø³Ø±Ø¹
  let currentSpeed = speed - Math.floor(score/5)*100;
  if(currentSpeed < 500) currentSpeed = 500;

  boxTimeout = setTimeout(()=>{
    box.style.display = "none";
    showBox();
  },currentSpeed);
}

box.onclick=function(){
  if(!gameRunning) return;
  clickSound.currentTime=0; clickSound.play();
  score++;
  document.getElementById("score").innerText="Ø§Ù„Ù†Ù‚Ø§Ø·: "+score;

  box.style.display="none";
  clearTimeout(boxTimeout);
  showBox();
}

function endGame(){
  gameRunning=false;
  box.style.display="none";
  clearInterval(timerInterval);
  clearTimeout(boxTimeout);

  if(score > highScore){
    highScore = score;
    localStorage.setItem("highScore", highScore);
    highScoreElement.innerText = "ğŸ† Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø·Ø©: "+highScore;
    highScoreElement.classList.add("animate");
    setTimeout(()=>{ highScoreElement.classList.remove("animate"); },600);
    alert("ğŸ† Ø±Ù‚Ù… Ù‚ÙŠØ§Ø³ÙŠ Ø¬Ø¯ÙŠØ¯!\nÙ†Ù‚Ø§Ø·Ùƒ: "+score);
  } else {
    alert("â° Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!\nÙ†Ù‚Ø§Ø·Ùƒ: "+score);
  }
}

// ===== Ø§Ù„Ø£Ø²Ø±Ø§Ø± =====
document.getElementById("startBtn").onclick=startWithSound;
document.getElementById("restartBtn").onclick=startWithSound;
document.getElementById("stopBtn").onclick=function(){
  if(!gameRunning) return;
  gameRunning=false;
  box.style.display="none";
  clearInterval(timerInterval);
  clearTimeout(boxTimeout);
  alert("ğŸ›‘ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù„Ø¹Ø¨Ø©!\nÙ†Ù‚Ø§Ø·Ùƒ: "+score);
}
</script>
</body>
</html>
